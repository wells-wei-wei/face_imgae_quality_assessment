% codegen cnn.m -args {zeros(100, 60)}
function R = cnn(x) %#codegen 

n = 7; % number of layers
L2_out = 4; % number of outputs in layer 2
L2_in = 1; % number of inputs in layer 2
L4_out = 8; % number of outputs in layer 4
L4_in = 4; % number of inputs in layer 4
L6_out = 16; % number of outputs in layer 6
L6_in = 8; % number of inputs in layer 6

%% Layer 2
L2_K_out01_in01 = ...
[0.2784042298 0.1911594307 0.1072880994 -0.0187940227 -0.2181428165 ;  ...
-0.0025452798 0.0937540024 0.2229925958 0.2520793762 -0.0514568745 ;  ...
0.1743313789 -0.0846269245 0.2945503369 0.2593296355 0.1658852577 ;  ...
0.1099280453 0.2553970288 0.2022373700 0.0265371904 -0.1944487968 ;  ...
0.2538918374 0.0558909759 -0.0778082510 0.2072768143 -0.1643539594 ];

L2_b_out01 = -0.3360195755;

L2_K_out02_in01 = ...
[-0.1497159357 -0.2896170857 -0.1276951936 0.0821395610 0.0016972800 ;  ...
-0.2632781529 -0.0959281883 -0.0788791107 -0.4205192511 -0.0496211870 ;  ...
-0.1009044475 -0.2529374148 -0.2549885982 -0.1743916971 -0.2207477125 ;  ...
-0.1680010390 0.0388384530 -0.3217011224 -0.2397548145 -0.2188177437 ;  ...
-0.0525764268 -0.0092894301 0.0428283387 0.1121998152 -0.1284734645 ];

L2_b_out02 = 0.9402924406;

L2_K_out03_in01 = ...
[-0.1380389473 0.1245047471 0.0599427357 0.1352690659 0.1462609882 ;  ...
0.1418318295 0.0568311680 0.3130112030 0.0733337621 0.0395279238 ;  ...
-0.0041034860 0.2926078902 0.3064459195 0.0797302423 0.3013766037 ;  ...
0.0680447842 0.2575797673 0.1980062755 0.0736569541 0.1576090827 ;  ...
-0.1788482064 0.0640248527 0.1933096817 0.0800202356 -0.0019473794 ];

L2_b_out03 = -0.6564641765;

L2_K_out04_in01 = ...
[0.1172345455 0.1416318574 0.2008615743 -0.1956953463 0.0041188748 ;  ...
0.0875203538 0.2515689712 -0.0707338878 -0.2121068302 -0.1237151654 ;  ...
0.0765759918 0.0957084642 -0.0443080648 0.2092104868 -0.0083681382 ;  ...
0.2110299156 0.2787356390 0.2560918985 -0.0674867179 -0.1576331201 ;  ...
0.1913404578 -0.0170217638 0.2111961270 -0.0065416597 0.2656693639 ];

L2_b_out04 = -0.1230881721;


%% Layer 4
L4_K_out01_in01 = ...
[0.1328998200 -0.0492405781 -0.1112541973 -0.0165005304 -0.0062551560 ;  ...
0.0344434888 -0.0085586094 -0.1274484529 -0.0200500133 -0.1063180877 ;  ...
0.0424059226 0.0243117712 -0.0330263682 -0.2506667166 0.0271396580 ;  ...
0.0246496800 -0.0002248762 -0.0184253096 -0.0551456207 -0.1814211593 ;  ...
0.1208280257 0.1115431078 0.0062797986 -0.1248038562 0.1101752137 ];

L4_K_out01_in02 = ...
[0.2861677321 0.1586177126 0.2588854862 0.3128899146 0.0899599937 ;  ...
0.3583423898 0.3549797454 0.4347899987 0.2661852055 0.2914661304 ;  ...
0.3220122503 0.2862415585 0.3275548102 0.4779023481 0.3406125190 ;  ...
0.1820142040 0.4205717495 0.3300139776 0.3792328730 0.2409939130 ;  ...
0.1153377421 0.2588488402 0.3699390044 0.1448094650 0.2189937706 ];

L4_K_out01_in03 = ...
[0.0343780325 -0.0688831201 -0.0404797011 -0.1642824336 -0.0609892697 ;  ...
-0.1478229041 -0.0582024448 -0.2871638645 -0.1582893297 -0.0384640636 ;  ...
-0.1708561331 -0.2448991062 -0.3098865880 -0.1115908636 -0.0772314177 ;  ...
-0.0431073326 -0.2084009946 -0.2077290254 -0.0401530630 -0.0675649704 ;  ...
-0.0377919684 0.0559116513 0.0088634449 0.0518665124 -0.0394522135 ];

L4_K_out01_in04 = ...
[0.1593288781 -0.0635468037 -0.0774776974 -0.0984641184 -0.0782171633 ;  ...
0.1349313121 -0.0053592600 0.0558837839 -0.1398998047 0.0597523486 ;  ...
0.1465295610 0.0748050720 -0.1187727263 -0.1919791860 -0.1332433948 ;  ...
0.1113286769 0.1672081241 0.0888300772 -0.1390211366 -0.0950801600 ;  ...
0.1867857706 0.0567022341 0.1893517433 0.0928795670 0.2062208643 ];

L4_b_out01 = 0.2454545652;

L4_K_out02_in01 = ...
[-0.0562123528 0.0069718713 0.1186301559 0.0341337930 -0.1350683526 ;  ...
-0.0592595868 -0.0967654113 -0.0374179249 0.1613225115 0.0966252369 ;  ...
-0.0555382607 -0.1066783110 -0.0511656344 0.0951433624 0.0105127311 ;  ...
-0.0496882424 0.0021447875 0.1401615741 0.1452863150 0.1378118622 ;  ...
-0.0628194911 0.0926783163 -0.0681947427 -0.1267098881 0.0696235419 ];

L4_K_out02_in02 = ...
[0.0153276189 -0.0810813990 -0.0808653382 -0.1128984511 -0.0029755325 ;  ...
-0.1124561011 0.0044058701 -0.1244512686 -0.2280846783 -0.0928345638 ;  ...
-0.1764679493 -0.1157260771 -0.1561804901 -0.0716637564 -0.1808050404 ;  ...
-0.1678847924 -0.0114091019 -0.0070840327 -0.0776305669 -0.0614831324 ;  ...
-0.1300027228 -0.0790057830 -0.2257068293 0.0488684235 -0.0060057783 ];

L4_K_out02_in03 = ...
[-0.0575593764 0.1177789713 -0.0811662547 0.0011162414 -0.0181213594 ;  ...
-0.1282595211 0.1343048384 0.1617578950 0.1545204156 0.0493445902 ;  ...
0.0009454239 0.0155275038 0.0865966195 0.0104713318 -0.0058008956 ;  ...
0.0830242437 0.0738673978 0.0924673165 0.0938745063 -0.0007333716 ;  ...
0.0653818181 0.0714975472 -0.0550543279 -0.0128174105 0.0433028360 ];

L4_K_out02_in04 = ...
[0.0608238886 0.0431842435 0.0530082174 -0.1108751855 0.0736511437 ;  ...
-0.0558347915 0.0036066579 0.1544226773 0.0694104539 0.0591565836 ;  ...
-0.0391092777 0.0808840046 0.1082950422 -0.0090682562 0.1614638828 ;  ...
-0.0013829476 -0.0126917916 0.0656825620 -0.0852366923 0.1421044464 ;  ...
-0.0267177455 -0.1201950161 -0.0211893065 0.0094733389 -0.1368770989 ];

L4_b_out02 = -0.0700575119;

L4_K_out03_in01 = ...
[-0.0852701199 0.0387734774 0.0491906473 0.1993400143 0.1140252871 ;  ...
-0.0093195924 0.0998632873 0.1330733825 0.1402589550 0.0595242211 ;  ...
-0.0954096595 0.1646974682 0.1708397452 0.0343326567 0.2101253979 ;  ...
-0.0396073972 0.0559417563 -0.0860920267 0.1570206084 -0.0878877119 ;  ...
-0.2475425270 -0.0124754015 0.0847362554 -0.0192323698 -0.0213856325 ];

L4_K_out03_in02 = ...
[-0.1655093531 -0.2186627894 -0.3316958298 -0.1693676613 -0.2839562760 ;  ...
-0.0356225033 -0.2126415445 -0.1481360869 -0.3453391271 -0.3234241274 ;  ...
-0.1781428737 -0.2230594158 -0.1828184244 -0.3245498265 -0.2798701381 ;  ...
-0.0324573653 -0.1293026503 -0.1122618868 -0.1688493769 -0.1956351593 ;  ...
-0.1430621006 -0.0337021854 -0.0186104856 -0.1085355472 -0.1009936270 ];

L4_K_out03_in03 = ...
[0.1190208779 -0.0227665095 0.1971731663 0.0591755696 0.1569526381 ;  ...
0.0582480884 0.1962544791 0.1734626837 0.0376995118 -0.0303471039 ;  ...
-0.0278150089 0.2188262471 0.1875043280 0.2198961527 0.1755135902 ;  ...
-0.0401111559 0.0537986734 -0.0498058107 0.1609359741 0.0968507218 ;  ...
-0.0775869200 -0.1895542115 -0.0438240819 -0.0346887151 -0.0718701729 ];

L4_K_out03_in04 = ...
[-0.0203895774 -0.0910742137 -0.0796214209 -0.0119269928 0.1674634618 ;  ...
0.0827528273 0.0045726975 0.0006169056 0.0990147835 0.0160242198 ;  ...
-0.0212637528 -0.0393845146 0.0608218503 0.0547318066 0.0166932161 ;  ...
-0.1658531129 -0.0669701985 -0.1101052825 -0.0059649109 -0.0547511982 ;  ...
-0.1719957971 -0.0720568393 -0.0380093327 -0.0414670974 -0.0808559604 ];

L4_b_out03 = -0.1388419696;

L4_K_out04_in01 = ...
[-0.0385468036 -0.0818843809 0.0845490852 0.1408484766 0.0742566722 ;  ...
0.0070203843 0.0284185977 -0.0220395395 0.0157158149 -0.0932128242 ;  ...
0.0484021428 0.0467069359 -0.0142797205 0.1522524157 -0.0128033519 ;  ...
0.1099869362 -0.0819669289 0.1121765878 0.0265425124 0.0273747974 ;  ...
-0.0161317110 0.0911221047 0.1228051975 0.1175634424 0.0774126151 ];

L4_K_out04_in02 = ...
[0.0063988906 -0.0534031843 0.0119623603 -0.0613414219 -0.0359883905 ;  ...
-0.0417671706 -0.0911377659 -0.1633372312 0.0528692928 0.0057789439 ;  ...
-0.0573174279 0.0513156622 -0.0136861464 -0.0149319734 -0.0893993470 ;  ...
-0.1566541397 0.0267523803 0.0484681911 0.0986674413 0.1308088989 ;  ...
-0.0446619437 0.0935464887 0.1062160859 0.0458751508 -0.0375845393 ];

L4_K_out04_in03 = ...
[-0.0959621809 0.1527868659 -0.0672712653 -0.0605107177 -0.1177551598 ;  ...
0.1229003486 -0.0525316110 0.0257280769 -0.0205990236 -0.1370843239 ;  ...
0.1747698580 0.1907335291 -0.0636256750 0.1368435581 0.0277149562 ;  ...
0.0007122953 0.1215697015 0.1544611122 -0.0005127980 -0.0926719310 ;  ...
-0.0213538689 0.1492055565 0.0600866240 -0.0946185379 0.0150259979 ];

L4_K_out04_in04 = ...
[-0.0878281637 0.0551870331 -0.0979683023 0.1535434468 0.1238677034 ;  ...
0.1072197001 0.1661169031 -0.0370189514 -0.0546205954 0.0848686342 ;  ...
-0.0001944212 -0.0159794970 0.1666025964 0.0341492181 0.0657640917 ;  ...
0.1240690582 0.1501669829 -0.0825941254 -0.0260986473 -0.0846324173 ;  ...
-0.1021338621 -0.0811969143 -0.0350396316 0.0737437849 -0.1005703457 ];

L4_b_out04 = 0.0117986307;

L4_K_out05_in01 = ...
[-0.1160572440 0.1280089094 -0.0368682158 0.0237138091 -0.0507967094 ;  ...
-0.0077583760 0.1012273938 0.1287044286 0.0638966272 -0.0033549246 ;  ...
0.1545978904 0.0954995251 0.1125965335 -0.0600712525 0.0268050701 ;  ...
0.1893802351 -0.0078530982 -0.0270722406 0.0562302947 0.0157414520 ;  ...
-0.1144539346 0.1253449864 0.0535331987 -0.1025019966 0.0493961996 ];

L4_K_out05_in02 = ...
[-0.2675108362 -0.0890127920 -0.1142892351 -0.1875312574 -0.0520152451 ;  ...
-0.2206970200 -0.2954117786 -0.1637186773 -0.1849513151 0.0098017852 ;  ...
-0.1033149993 -0.3105656890 -0.1081838098 -0.1470654241 0.0911109745 ;  ...
-0.2214230896 -0.3115986767 -0.1279718271 -0.1651287634 -0.0397317991 ;  ...
-0.0103305414 -0.2153348439 -0.1155825195 0.0035124653 0.1082112094 ];

L4_K_out05_in03 = ...
[0.1430634663 -0.0428372678 0.0984654537 -0.1114436131 -0.1075599998 ;  ...
0.2041237729 -0.0193220384 0.1034184515 -0.1325297022 0.0477178906 ;  ...
-0.0100173905 0.1737912427 0.1772235864 -0.1068561670 -0.1304166206 ;  ...
0.1704894532 0.1447627016 -0.0118323225 0.0978406738 0.0408861138 ;  ...
0.1610251780 0.0889742918 -0.0037307235 -0.0761844768 -0.0407594816 ];

L4_K_out05_in04 = ...
[0.1189348480 -0.0662340772 0.1518067693 -0.1362135528 0.0176363971 ;  ...
0.0256802301 0.0445064042 -0.0460022199 0.1207009408 -0.0967982638 ;  ...
0.1710647513 0.0238846716 -0.0674984263 -0.1162561830 0.0995307682 ;  ...
-0.0183640405 0.0764469146 0.0462644914 0.0097337862 -0.1363342540 ;  ...
0.0019098119 0.0553174198 0.1367236217 -0.1048030314 -0.0465738276 ];

L4_b_out05 = -0.0939675642;

L4_K_out06_in01 = ...
[0.2160539761 -0.0253383139 -0.0034471636 0.1449251966 -0.0989476711 ;  ...
0.2049476759 -0.0563731956 -0.0537707666 0.0175150709 -0.1640138510 ;  ...
0.0079769453 0.0299386414 0.0852561218 -0.1249214906 -0.1227860192 ;  ...
0.0194911804 0.0682836309 0.0021439584 -0.0101631176 -0.1758661082 ;  ...
0.0240743212 -0.0260845017 -0.1051120591 -0.0097999743 -0.1828136017 ];

L4_K_out06_in02 = ...
[0.0578370040 -0.0669782675 -0.0334846934 0.1032842695 -0.0441332033 ;  ...
-0.1050688816 -0.0100247427 0.0896472384 0.1978691044 0.1856992946 ;  ...
-0.1189850960 -0.0814262848 0.0033763590 0.1444004624 0.0346574226 ;  ...
0.0991767345 0.1852706384 0.1436966576 0.2771127688 0.1764183525 ;  ...
0.0480578143 0.1795641631 0.0663747964 0.2185522479 0.1792979640 ];

L4_K_out06_in03 = ...
[0.1738730743 -0.0367313669 -0.0959735315 0.1226251652 0.1178242676 ;  ...
0.0317841429 -0.1197650182 -0.1169909354 -0.1396782316 -0.0831229292 ;  ...
0.0191157437 0.0725867436 -0.0768158632 -0.1041081116 0.0030461625 ;  ...
0.0114778235 -0.0235464176 -0.0927471016 -0.1393753438 -0.1017763696 ;  ...
0.0440708951 -0.1073822620 -0.1883551139 -0.1723993032 -0.0969443993 ];

L4_K_out06_in04 = ...
[0.0872800286 0.1596481868 0.1250647524 0.1160416249 0.0189459540 ;  ...
-0.0269778554 0.1292832669 -0.0745503292 0.0812833391 0.0099269042 ;  ...
0.0561847558 0.0815227723 -0.0205921700 -0.0778761492 0.0056712395 ;  ...
0.0788553840 0.0054828142 -0.1504896561 0.0708567897 -0.0125502109 ;  ...
-0.0974270017 -0.0982673265 -0.0601241047 -0.0333925548 0.0171662876 ];

L4_b_out06 = 0.0638579814;

L4_K_out07_in01 = ...
[0.0123389534 0.1037017400 0.1021434446 0.1341797131 0.1397912501 ;  ...
0.0805836231 -0.0279855534 0.0747886576 -0.0318262631 0.0466432971 ;  ...
0.0306080015 0.0543768205 -0.1044691127 -0.0880906897 0.0765087856 ;  ...
0.0561304037 -0.0759193292 0.0492423416 0.0265492601 0.1080351817 ;  ...
0.1522622624 -0.0475120677 0.0118714023 0.1624892681 -0.0883652032 ];

L4_K_out07_in02 = ...
[-0.1400765848 0.0786391210 0.1088582379 0.0100761442 -0.0143935594 ;  ...
0.0017516517 0.0194729596 0.0556861370 0.0572603392 -0.0991182269 ;  ...
-0.1559246774 -0.1573813482 -0.0572096925 0.0556019578 0.0032950148 ;  ...
-0.0296241161 0.0914636840 -0.0696191019 -0.0259889266 0.0304525714 ;  ...
-0.0949786745 0.0627543252 -0.0124764811 0.0723678322 0.0416167116 ];

L4_K_out07_in03 = ...
[0.1381702294 0.0187577215 -0.0708980416 0.0121203908 -0.1172953250 ;  ...
0.1019155417 0.0667746663 -0.0703569340 0.1167170421 0.0567784869 ;  ...
0.0993210495 0.1194459223 -0.0394318197 -0.0216337944 0.0474728442 ;  ...
0.1347894080 0.0205154103 -0.0736284216 -0.0404254981 0.0753656656 ;  ...
0.1620832994 0.0333538708 -0.0724275787 0.1436660211 -0.0302958312 ];

L4_K_out07_in04 = ...
[-0.0659456964 -0.0321380453 0.0311469792 0.0248874763 -0.1195061792 ;  ...
-0.0061045128 0.0379465503 0.0189505937 0.1076557563 0.1003912586 ;  ...
-0.0360292988 -0.0847429289 0.1536311680 -0.0595543962 0.1529842278 ;  ...
0.0683694155 -0.0725093656 -0.0524066446 0.1406457288 0.1121869621 ;  ...
0.1378775800 -0.0477585261 0.0108047623 0.1375443869 0.1367357050 ];

L4_b_out07 = 0.0106526286;

L4_K_out08_in01 = ...
[-0.0825281280 0.0316304677 -0.0223469191 -0.1185703464 0.1151201093 ;  ...
0.0414077354 -0.1554752598 0.0354763833 -0.0847353056 0.0683948164 ;  ...
0.1081604882 0.1141670263 0.0010270780 -0.1486224458 -0.1042772060 ;  ...
-0.0480078006 0.0993627805 -0.0786045447 -0.0559694384 -0.1571937284 ;  ...
0.0381540108 0.0579289735 0.0963369114 -0.0564954115 -0.1501152575 ];

L4_K_out08_in02 = ...
[0.0336091459 -0.0840812838 -0.0331143887 -0.0567306724 -0.0306659606 ;  ...
0.0959008400 0.0774235137 -0.0245168545 0.0873252842 -0.0109490842 ;  ...
0.1200736783 0.1700030333 0.0621264823 -0.0707711872 0.1173266152 ;  ...
0.0626010308 0.1243624166 -0.0514027136 -0.0284671734 0.1760023550 ;  ...
-0.0640655182 0.1376517199 -0.0572592189 0.0765377542 -0.0749980405 ];

L4_K_out08_in03 = ...
[-0.1225844117 0.0279013567 0.1152118630 0.0950260846 0.1168159322 ;  ...
-0.1215393221 -0.0890086601 -0.0778844990 0.0376026770 -0.1181332716 ;  ...
-0.1162912296 -0.1115029937 0.0180797103 -0.0769839686 0.0367766559 ;  ...
0.1056736744 0.0385496601 0.0960314688 0.0311688992 0.0011719494 ;  ...
-0.0941824250 0.0131167893 0.0148812726 -0.1070662359 -0.1060662942 ];

L4_K_out08_in04 = ...
[-0.1320684191 0.1270216290 -0.0868282855 -0.1456920287 -0.1082251621 ;  ...
-0.0652558710 0.0394046958 -0.1067271222 0.0863689912 -0.1174755292 ;  ...
0.1299390268 -0.1369185860 -0.1375611495 -0.0638216953 -0.0765505729 ;  ...
0.1330537192 0.0262567981 -0.1484981158 0.0488398796 -0.1488620748 ;  ...
-0.0609892326 -0.0199318812 0.0856980462 0.1317062873 -0.0430065835 ];

L4_b_out08 = 0.0202107176;


%% Layer 2
L2_a01 = convn(x, L2_K_out01_in01, 'valid');
L2_a01 = 1./(1+exp(-L2_a01-L2_b_out01));

L2_a02 = convn(x, L2_K_out02_in01, 'valid');
L2_a02 = 1./(1+exp(-L2_a02-L2_b_out02));

L2_a03 = convn(x, L2_K_out03_in01, 'valid');
L2_a03 = 1./(1+exp(-L2_a03-L2_b_out03));

L2_a04 = convn(x, L2_K_out04_in01, 'valid');
L2_a04 = 1./(1+exp(-L2_a04-L2_b_out04));


%% Layer 3
L3_a01 = convn(L2_a01, [0.25 0.25; 0.25 0.25], 'valid'); L3_a01 = L3_a01(1:2:end, 1:2:end);
L3_a02 = convn(L2_a02, [0.25 0.25; 0.25 0.25], 'valid'); L3_a02 = L3_a02(1:2:end, 1:2:end);
L3_a03 = convn(L2_a03, [0.25 0.25; 0.25 0.25], 'valid'); L3_a03 = L3_a03(1:2:end, 1:2:end);
L3_a04 = convn(L2_a04, [0.25 0.25; 0.25 0.25], 'valid'); L3_a04 = L3_a04(1:2:end, 1:2:end);

%% Layer 4
L4_a01 = convn(L3_a01, L4_K_out01_in01, 'valid');
L4_a01 = L4_a01 + convn(L3_a02, L4_K_out01_in02, 'valid');
L4_a01 = L4_a01 + convn(L3_a03, L4_K_out01_in03, 'valid');
L4_a01 = L4_a01 + convn(L3_a04, L4_K_out01_in04, 'valid');
L4_a01 = 1./(1+exp(-L4_a01-L4_b_out01));

L4_a02 = convn(L3_a01, L4_K_out02_in01, 'valid');
L4_a02 = L4_a02 + convn(L3_a02, L4_K_out02_in02, 'valid');
L4_a02 = L4_a02 + convn(L3_a03, L4_K_out02_in03, 'valid');
L4_a02 = L4_a02 + convn(L3_a04, L4_K_out02_in04, 'valid');
L4_a02 = 1./(1+exp(-L4_a02-L4_b_out02));

L4_a03 = convn(L3_a01, L4_K_out03_in01, 'valid');
L4_a03 = L4_a03 + convn(L3_a02, L4_K_out03_in02, 'valid');
L4_a03 = L4_a03 + convn(L3_a03, L4_K_out03_in03, 'valid');
L4_a03 = L4_a03 + convn(L3_a04, L4_K_out03_in04, 'valid');
L4_a03 = 1./(1+exp(-L4_a03-L4_b_out03));

L4_a04 = convn(L3_a01, L4_K_out04_in01, 'valid');
L4_a04 = L4_a04 + convn(L3_a02, L4_K_out04_in02, 'valid');
L4_a04 = L4_a04 + convn(L3_a03, L4_K_out04_in03, 'valid');
L4_a04 = L4_a04 + convn(L3_a04, L4_K_out04_in04, 'valid');
L4_a04 = 1./(1+exp(-L4_a04-L4_b_out04));

L4_a05 = convn(L3_a01, L4_K_out05_in01, 'valid');
L4_a05 = L4_a05 + convn(L3_a02, L4_K_out05_in02, 'valid');
L4_a05 = L4_a05 + convn(L3_a03, L4_K_out05_in03, 'valid');
L4_a05 = L4_a05 + convn(L3_a04, L4_K_out05_in04, 'valid');
L4_a05 = 1./(1+exp(-L4_a05-L4_b_out05));

L4_a06 = convn(L3_a01, L4_K_out06_in01, 'valid');
L4_a06 = L4_a06 + convn(L3_a02, L4_K_out06_in02, 'valid');
L4_a06 = L4_a06 + convn(L3_a03, L4_K_out06_in03, 'valid');
L4_a06 = L4_a06 + convn(L3_a04, L4_K_out06_in04, 'valid');
L4_a06 = 1./(1+exp(-L4_a06-L4_b_out06));

L4_a07 = convn(L3_a01, L4_K_out07_in01, 'valid');
L4_a07 = L4_a07 + convn(L3_a02, L4_K_out07_in02, 'valid');
L4_a07 = L4_a07 + convn(L3_a03, L4_K_out07_in03, 'valid');
L4_a07 = L4_a07 + convn(L3_a04, L4_K_out07_in04, 'valid');
L4_a07 = 1./(1+exp(-L4_a07-L4_b_out07));

L4_a08 = convn(L3_a01, L4_K_out08_in01, 'valid');
L4_a08 = L4_a08 + convn(L3_a02, L4_K_out08_in02, 'valid');
L4_a08 = L4_a08 + convn(L3_a03, L4_K_out08_in03, 'valid');
L4_a08 = L4_a08 + convn(L3_a04, L4_K_out08_in04, 'valid');
L4_a08 = 1./(1+exp(-L4_a08-L4_b_out08));


%% Layer 5
L5_a01 = convn(L4_a01, [0.25 0.25; 0.25 0.25], 'valid'); L5_a01 = L5_a01(1:2:end, 1:2:end);
L5_a02 = convn(L4_a02, [0.25 0.25; 0.25 0.25], 'valid'); L5_a02 = L5_a02(1:2:end, 1:2:end);
L5_a03 = convn(L4_a03, [0.25 0.25; 0.25 0.25], 'valid'); L5_a03 = L5_a03(1:2:end, 1:2:end);
L5_a04 = convn(L4_a04, [0.25 0.25; 0.25 0.25], 'valid'); L5_a04 = L5_a04(1:2:end, 1:2:end);
L5_a05 = convn(L4_a05, [0.25 0.25; 0.25 0.25], 'valid'); L5_a05 = L5_a05(1:2:end, 1:2:end);
L5_a06 = convn(L4_a06, [0.25 0.25; 0.25 0.25], 'valid'); L5_a06 = L5_a06(1:2:end, 1:2:end);
L5_a07 = convn(L4_a07, [0.25 0.25; 0.25 0.25], 'valid'); L5_a07 = L5_a07(1:2:end, 1:2:end);
L5_a08 = convn(L4_a08, [0.25 0.25; 0.25 0.25], 'valid'); L5_a08 = L5_a08(1:2:end, 1:2:end);


R = [L5_a01 L5_a02 L5_a03 L5_a06]; R = R(:)';

end